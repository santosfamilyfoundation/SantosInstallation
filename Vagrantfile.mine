# -*- mode: ruby -*-
# vi: set ft=ruby :
require 'getoptlong'

opts = GetoptLong.new(
  ['--provider', GetoptLong::OPTIONAL_ARGUMENT],
)

provider = 'virtualbox'
begin opts.each do |opt, arg|
    case opt
      when '--provider'
        provider=arg
    end # case
  end # each
  rescue
end

# All Vagrant configuration is done below. The "2" in Vagrant.configure
# configures the configuration version (we support older styles for
# backwards compatibility). Please don't change it unless you know what
# you're doing.
Vagrant.configure("2") do |config|
  config.vm.hostname = "vagrant"
  config.vm.define "default-#{provider}"

  config.vm.provider "virtualbox" do |vbox, override|
    override.vm.box = "ubuntu/trusty64"
    override.vm.box_check_update = false
    override.vm.network "forwarded_port", guest: 8888, host: 8088
    vbox.memory = "1024"
  end

  config.vm.provider :aws do |aws, override|
    override.vm.box = "dummy"
    aws.access_key_id = "ASIAIHOUPIFBBDWBHWVA"
    aws.secret_access_key = "zQC5OiOlMv2wbVwhhTbA2zAd9ExFezypXAYLJwQV"
    aws.session_token = "FQoDYXdzEE0aDKDIr6IZqBAIKG7+VCKsAV+7KL9pgJL+BW9Sed7GohlLIHuvJWNztOTVjmA47ayME5UYhmWRpb3CCUhs+GA+ZuYvEz1nJKdAtw/jF0vvAgYuzTjtVHom86pqxa8JiLs69H3YDDH+lbs8JndeY5hqKfnc0EbhRvHVsVTF+YnIIWTuHeflh0L7d6S+3wtIhhZJA9HSH01A1ov5FUk0xnuRmAiYBlggwigaeWv5L0jYcYNYNtWWTvqos8YWvAAo5Yz/wwU="
    aws.keypair_name = "desktopKey"

    # aws.ami = "ami-b7075dd2"
    aws.ami = "ami-a93631be"
    aws.region = "us-east-1"
    override.ssh.username = "ubuntu"
    override.ssh.private_key_path = "/home/philip/.ssh/id_rsa"
  end

  # Custom shell scripts
  config.vm.provision :shell, path: "install.sh", privileged: false
end
